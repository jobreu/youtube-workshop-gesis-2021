<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Automatic Sampling and Analysis of YouTube Data</title>
    <meta charset="utf-8" />
    <meta name="author" content="Julian Kohne Johannes Breuer M. Rohangis Mohseni" />
    <meta name="date" content="2020-02-10" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Copy Code","success":"Copied!","error":"Press Ctrl+C to Copy"})</script>
    <link href="libs/xaringanExtra-extra-styles/xaringanExtra-extra-styles.css" rel="stylesheet" />
    <link rel="stylesheet" href="../workshop.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Automatic Sampling and Analysis of YouTube Data
## Setting Up Access to the YouTube API
### Julian Kohne<br />Johannes Breuer<br />M. Rohangis Mohseni
### 2020-02-10

---

layout: true

&lt;style&gt;

.center2 {
  margin: 0;
  position: absolute;
  top: 50%;
  left: 50%;
  -ms-transform: translate(-50%, -50%);
  transform: translate(-50%, -50%);
}

&lt;/style&gt;



&lt;div class="my-footer"&gt;
  &lt;div style="float: left;"&gt;&lt;span&gt;Julian Kohne, Johannes Breuer, M. Rohangis Mohseni&lt;/span&gt;&lt;/div&gt;
  &lt;div style="float: right;"&gt;&lt;span&gt;GESIS, Cologne, Germany, 2020-02-10&lt;/span&gt;&lt;/div&gt;
  &lt;div style="text-align: center;"&gt;&lt;span&gt;Setting Up Access to the YouTube API&lt;/span&gt;&lt;/div&gt;
&lt;/div&gt;

---


# Setting up API access to the *YouTube* API
 
To effectively work with *YouTube* data, we need access to its Application Programming Interface (API). As this process, unfortunately, can be a bit tedious, we prepared this preliminary tutorial so you don't have to spend time setting up your API access during the workshop. Please follow this tutorial and check if the setup works before the workshop. If your setup does not work, feel free to contact us before the workshop (the sooner the better) and we'll try to assist you in setting up access to the *YouTube* API. If, for some reason, setting up access to the API does not work for you and we don't find a solution or if you cannot access the API during the workshop, we will have some data prepared that you can then work with in the workshop.

Contact: julian-kohne@gesis.org
  
[HINT](https://en.wikipedia.org/wiki/YouTube): Pink texts in the slides are hyperlinks that you can simply click on

---
# Setting up API Access
  
- For starters, you need a *Gmail* account
- We suggest that you create a new account specifically for this workshop, so you don't mess up or accidentally share the credentials of your private or work account 

- You can create a new account [here](https://accounts.google.com/signup/v2/webcreateaccount?service=mail&amp;continue=https%3A%2F%2Fmail.google.com%2Fmail%2F&amp;ltmpl=googlemail&amp;gmb=exp&amp;biz=false&amp;flowName=GlifWebSignIn&amp;flowEntry=SignUp)

- Next, you need to:
  - Sign up for the *Google developer console*
  - Create a new project
  - Activate the *YouTube Data API*
  - Create authentication credentials
  - Test the credentials from R

We will explain these steps in detail on the following slides.

---
# Google Developer Console
  
- Go to the [Developer Console](https://console.developers.google.com) and log in with your (new) *Google* Account

![plot](Images/1.png)
![plot](Images/2.png)
---
# Accepting the Terms of Service

- You need to accept the Google Developer ToS, deselect the email updates and click "Agree and continue"

![plot](Images/3.jpg)
---
# Creating a Project

- On the top right of the screen, click on "create project" to start a new project

![plot](Images/4.png)
---
# Creating a Project

- Enter a project name and click on "create", you don't need to specify an organization

![plot](Images/5.png)
---
# Enabling YouTube Data API v3

- On the next screen, click on "Enable APIs and services" in the top left

![plot](Images/6.png)
---
# Enabling YouTube Data API v3

- Enter "YouTube" in the search bar and select "YouTube Data API v3" by clicking on it

![plot](Images/7.png)
---
# Enabling YouTube Data API v3

- Next, click on the blue "Enable" button on the left side 

![plot](Images/8.png)

---
# Setting up Credentials

- Click on the "Create credentials" button on the top right of your screen

![plot](Images/9.png)
---
# Setting up Credentials

- Select "YouTube Data API v3", "Other UI" and "User data" in the respective field
and click on "What credentials do I need?" on the bottom of the screen

![plot](Images/10.png)

---
# Configuring Consent Screen

- A popup will prompt you to set up as consent screen before proceeding, click on "Set up consent screen"

![plot](Images/11.png)

---
# Configuring Consent Screen

- Select "External" and click on "create"

![plot](Images/12.png)

---
# Configure Scopes

- On the next screen, enter an arbitrary app name and enter your gmail address twice as "User support Email" and "Developer Contact Information". you can leave the other fields blank.

![plot](Images/13.png)

---
# Configure scopes

- Next, click on "Add or remove scopes" to open a side panel on the right side. In this panel, select all
fields for the YouTube Data API v3 and click on "update" on the bottom right. Be sure to check all items on all
pages.

![plot](Images/14.png)
---
# Configure scopes

- Click on "safe and continue" and the bottom left of the page

![plot](Images/15.png)

---
# Add yourself as a user

- On the subsequent page, click on "Add users", enter your gmail address and confirm by clicking "add".

![plot](Images/16.png)
---
# Add yourself as a user

- On the bottom left of the next page, click on "Back to dashboard"

![plot](Images/17.png)
---
# Setting up Credentials (2)

- On the dashboard page, click on "Credentials" in the menu on the top left

![plot](Images/18.png)
---
# Setting up Credentials (2)

- On the top, click on "Create Credentials" and select "OAuth Client ID" from the dropdown menu

![plot](Images/19.png)
---
# Setting up Credentials (2)

- Select "Desktop App" as your application type and enter an arbitrary name for the set of credentials, then click on the blue "create" button

![plot](Images/20.png)
---
# Setting up Credentials (2)

- Congratulations! You now have your own Client ID and secret! Next, copy both as a string into an R-script.

![plot](Images/21.png)

---
# Testing Access

- You can safely try whether your *YouTube API access* works as intended by running the 
  following commands in `R`:


```r
# installing the tuber package if not installed already
if("tuber" %in% installed.packages() != TRUE) {
  install.packages("tuber")
}

# loading tuber package
library(tuber)

# Your Credentials (NEVER SHARE THIS INFORMATION)
ID &lt;- "ENTER-YOUR-CLIENT-ID"
secret &lt;- "ENTER-YOUR-CLIENT-SECRET"

# authentication
yt_oauth(ID,secret)

# You will be asked in the R-console to
# save an access token: Select no by entering 2
# You will be send to your browser to log in
```
---
# Grant yourself access

- In the webbrowser window that was opened from your R session, select your new gmail account

![plot](Images/22.png)
---
# Grant yourself access

- Google warns you that the app has not been verified, you can trust yourself and click on "continue"

![plot](Images/23.png)
---
# Grant yourself access

- Allow the app (and hence yourself) to make changes to the account you created

![plot](Images/24.png)
---
# Grant yourself access

- confirm your choices once more by clicking on "Allow"

.center.middle[
![plot](Images/25.png)
]

---
# Grant yourself access

- Your browser should now display the following message. You can close his window now and return to R

![plot](Images/26.png)

---
# Test API call

- To easily check if everything worked, let's try to collect some simple data about a video.


```r
# get statistics of https://www.youtube.com/watch?v=HluANRwPyNo
get_stats(video_id="HluANRwPyNo")
```

---
# Output

- If everything worked correctly, your output structure should look something like this.
  The actual numbers will vary because they might change in the meantime.


```r
$id
[1] "HluANRwPyNo"

$viewCount
[1] "10244939"

$likeCount
[1] "509791"

$dislikeCount
[1] "4799"

$favoriteCount
[1] "0"

$commentCount
[1] "20581"
```
---
# A Few Words of Advice on Handling Your *YouTube API Access*

- Have one account and project ready for the workshop for which you know that it works
- Do not use your API access too excessively before the workshop to avoid any risk of it being suspended
  
- Never share your OAuth login credentials! This can easily happen by accident when:
  - saving code in a GitHub Repo
  - sending scripts to colleagues
  - troubleshooting someone elses code
  - for added security you can use the [`keyring` package](https://cran.r-project.org/web/packages/keyring/keyring.pdf) (we'll say a bit more about this in the workshop)
 
---
class: center, middle

# We hope that you are now all set up and look forward to seeing you online!
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
